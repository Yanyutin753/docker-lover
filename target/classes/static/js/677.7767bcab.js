"use strict";(self["webpackChunkyy2"]=self["webpackChunkyy2"]||[]).push([[677],{6245:function(e,a,l){function o(e){this.message=e}o.prototype=new Error,o.prototype.name="InvalidCharacterError";var t="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var a=String(e).replace(/=+$/,"");if(a.length%4==1)throw new o("'atob' failed: The string to be decoded is not correctly encoded.");for(var l,t,n=0,r=0,u="";t=a.charAt(r++);~t&&(l=n%4?64*l+t:t,n++%4)?u+=String.fromCharCode(255&l>>(-2*n&6)):0)t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(t);return u};function n(e){var a=e.replace(/-/g,"+").replace(/_/g,"/");switch(a.length%4){case 0:break;case 2:a+="==";break;case 3:a+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(t(e).replace(/(.)/g,(function(e,a){var l=a.charCodeAt(0).toString(16).toUpperCase();return l.length<2&&(l="0"+l),"%"+l})))}(a)}catch(e){return t(a)}}function r(e){this.message=e}function u(e,a){if("string"!=typeof e)throw new r("Invalid token specified");var l=!0===(a=a||{}).header?0:1;try{return JSON.parse(n(e.split(".")[l]))}catch(e){throw new r("Invalid token specified: "+e.message)}}r.prototype=new Error,r.prototype.name="InvalidTokenError",a.Z=u},1863:function(e,a,l){l.r(a),l.d(a,{default:function(){return Z}});var o=l(2876),t=(l(2278),l(6907)),n=(l(4746),l(5185)),r=(l(3349),l(8136)),u=(l(2219),l(4385)),i=(l(5077),l(3164)),s=(l(6335),l(7961)),c=(l(1605),l(1116)),d=(l(8825),l(294)),m=(l(6870),l(1206)),v=(l(103),l(6233)),p=(l(9840),l(2406)),h=(l(6615),l(6252));const f={style:{"--van-nav-bar-icon-color":"#f19290"}},w={class:"page-container"},g={class:"add_produce"},k={style:{display:"flex","justify-content":"center","align-items":"center"}},b=["src"],y=(0,h._)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no"},null,-1),C={class:"footer_produce"};function _(e,a,l,_,x,V){const I=p.l2,W=v.j,P=m.oF,H=d.JO,U=c.gb,T=s.Qm,Z=i.gN,L=u.cW,N=r.GI,S=n.l0,j=t.zx,F=o.Vq;return(0,h.wg)(),(0,h.iD)(h.HY,null,[(0,h._)("div",f,[(0,h.Wm)(I,{title:"添加商品","left-text":"","left-arrow":"",onClickLeft:_.onClickLeft},null,8,["onClickLeft"])]),(0,h._)("div",w,[(0,h._)("div",g,[(0,h.Wm)(P,{autoplay:3e3,"indicator-color":"#F19290","lazy-render":""},{default:(0,h.w5)((()=>[((0,h.wg)(!0),(0,h.iD)(h.HY,null,(0,h.Ko)(_.images,(e=>((0,h.wg)(),(0,h.j4)(W,{key:e},{default:(0,h.w5)((()=>[(0,h._)("div",k,[(0,h._)("img",{src:e,class:"image-slider",alt:"商品图片"},null,8,b)])])),_:2},1024)))),128))])),_:1}),_.isLoading?((0,h.wg)(),(0,h.j4)(U,{key:0,vertical:"",class:"loading-overlay"},{icon:(0,h.w5)((()=>[(0,h.Wm)(H,{name:"star-o",size:"30"})])),default:(0,h.w5)((()=>[(0,h.Uk)(" 加载中... ")])),_:1})):(0,h.kq)("",!0),(0,h.Wm)(S,{class:"form-container_produceAdd"},{default:(0,h.w5)((()=>[y,(0,h.Wm)(T,{modelValue:_.fileList,"onUpdate:modelValue":a[0]||(a[0]=e=>_.fileList=e),"after-read":_.afterRead,"upload-text":"商品图片",reupload:"","max-count":"1"},null,8,["modelValue","after-read"]),(0,h.Wm)(Z,{modelValue:_.presetIndex,"onUpdate:modelValue":a[1]||(a[1]=e=>_.presetIndex=e),"is-link":"",readonly:"",label:"🔖选择预设",placeholder:"选择预设",onClick:a[2]||(a[2]=e=>_.showPicker=!0)},null,8,["modelValue"]),(0,h.Wm)(N,{show:_.showPicker,"onUpdate:show":a[4]||(a[4]=e=>_.showPicker=e),round:"",position:"bottom "},{default:(0,h.w5)((()=>[(0,h.Wm)(L,{columns:_.columns,onCancel:a[3]||(a[3]=e=>_.showPicker=!1),onConfirm:_.onConfirm},null,8,["columns","onConfirm"])])),_:1},8,["show"]),(0,h.Wm)(Z,{label:"📌商品名称",modelValue:_.title,"onUpdate:modelValue":a[5]||(a[5]=e=>_.title=e),placeholder:"请输入商品名称",clearable:""},null,8,["modelValue"]),(0,h.Wm)(Z,{label:"📝商品详情",modelValue:_.desc,"onUpdate:modelValue":a[6]||(a[6]=e=>_.desc=e),placeholder:"请输入商品详情",type:"textarea",clearable:""},null,8,["modelValue"]),(0,h.Wm)(Z,{label:"💰积分价格",modelValue:_.credit,"onUpdate:modelValue":a[7]||(a[7]=e=>_.credit=e),placeholder:"请输入商品积分价格(整数)",clearable:""},null,8,["modelValue"]),(0,h.Wm)(Z,{label:"🧩商品数量",modelValue:_.num,"onUpdate:modelValue":a[8]||(a[8]=e=>_.num=e),placeholder:"请输入商品数量",clearable:""},null,8,["modelValue"]),(0,h.Wm)(Z,{modelValue:_.useName,"onUpdate:modelValue":a[9]||(a[9]=e=>_.useName=e),"is-link":"",readonly:"",name:"picker",label:"🤖商品对象",placeholder:"点击选择商品对象",onClick:a[10]||(a[10]=e=>_.showPicker_1=!0)},null,8,["modelValue"]),(0,h.Wm)(N,{show:_.showPicker_1,"onUpdate:show":a[12]||(a[12]=e=>_.showPicker_1=e),position:"bottom"},{default:(0,h.w5)((()=>[(0,h.Wm)(L,{columns:_.userColumns,onConfirm:_.onConfirm_1,onCancel:a[11]||(a[11]=e=>_.showPicker_1=!1)},null,8,["columns","onConfirm"])])),_:1},8,["show"])])),_:1}),(0,h._)("div",C,[(0,h.Wm)(j,{class:"btn-reset",type:"default",onClick:_.resetItem},{default:(0,h.w5)((()=>[(0,h.Uk)("重置")])),_:1},8,["onClick"]),(0,h.Wm)(j,{class:"btn-save",color:"#F19290",type:"primary",onClick:_.saveItem},{default:(0,h.w5)((()=>[(0,h.Uk)("保存")])),_:1},8,["onClick"])])]),(0,h.Wm)(F,{show:_.show,"onUpdate:show":a[13]||(a[13]=e=>_.show=e),title:"🥰 温馨提示",message:_.message,"show-cancel-button":!1},null,8,["show","message"]),(0,h.Wm)(F,{show:_.show_1,"onUpdate:show":a[14]||(a[14]=e=>_.show_1=e),title:"🥰恭喜",message:_.message,width:"70vw",height:"30vw","show-cancel-button":!1,"show-confirm-button":!1},null,8,["show","message"])])],64)}var x=l(2262),V=l(6154),I=l.p+"img/Item.c2c222bd.gif",W=l(2119),P=l(6245),H={components:{VanField:i.ZP,VanForm:n.ZP,VanButton:t.ZP,VanSwipe:m.ZP,VanSwipeItem:v.Z},setup(){const e=(0,x.iH)(!1),a=(0,x.iH)(!1),l=(0,x.iH)(""),o=(0,x.iH)(!1),t=[I],n=(0,x.iH)([]),r=(0,x.iH)("无预设"),u=(0,x.iH)(""),i=(0,x.iH)(""),s=(0,x.iH)(""),c=(0,x.iH)(""),d=(0,x.iH)("");let m=(0,x.iH)("");const v=(0,x.iH)(!1),p=(0,W.tv)(),f=()=>p.replace("/Produce"),w=(0,x.iH)([]),g=(0,x.iH)(!1);(0,h.bv)((()=>{C(),_()}));const k=localStorage.getItem("jwtToken");k||p.replace("/login");const b={Authorization:`Bearer ${k}`};let y="";const C=()=>{V.Z.post("/api/loginToken?token="+k).then((e=>{if(0==e.data.code)return console.error(e.data.data),void p.replace("/login");const a=(0,P.Z)(k);y=a.id})).catch((e=>{console.error("请求loginToken接口失败",e),p.replace("/login")}))},_=async()=>{try{const e=await V.Z.get("/api/user",{headers:b}),a=e.data.data;w.value=a.filter((e=>e.nameId!==y)).map((e=>({text:e.name,value:e.nameId})))}catch(e){console.error("获取用户数据时出错",e)}},H=({selectedOptions:e})=>{c.value=e[0]?.text,g.value=!1},U=[{text:"无预设",value:"0"},{text:"薯片",value:"1"},{text:"奶茶券",value:"2"},{text:"夜宵券",value:"3"},{text:"做运动",value:"4"},{text:"吃顿好的",value:"5"},{text:"不赖床",value:"6"},{text:"买小礼物",value:"7"},{text:"跑腿券",value:"8"},{text:"衣服裤子",value:"9"},{text:"好看鞋子",value:"10"},{text:"小吃一样",value:"11"}],T=({selectedOptions:e})=>{v.value=!1,r.value=e[0].text,Z(r.value)},Z=e=>{"薯片"===e?(u.value="美味薯片",i.value="诱人的零食，夜宵绝佳伴侣，咔嘣脆！凭此商品可以向对方索要薯片。"):"奶茶券"===e?(u.value="奶茶权限",i.value="凭此券可以向对方索要一杯奶茶。"):"夜宵券"===e?(u.value="夜宵放开闸",i.value="凭此券可以让自己在夜里狂野干饭。"):"做运动"===e?(u.value="减肥券",i.value="凭此券可以逼迫对方做一次运动，以此来达到减肥维持健康的目的。"):"吃顿好的"===e?(u.value="饭票",i.value="凭此券可以让对方做一次或请一次饭，具体视情况而定。"):"不赖床"===e?(u.value="早起券",i.value="凭此券可以让对方早起床一次。熬夜对身体很不好，还是要早点睡觉第二天才能有精神！"):"买小礼物"===e?(u.value="小礼物盒",i.value="凭此券可以让对方买点小礼物，像泡泡马特什么的。"):"跑腿券"===e?(u.value="跑腿召唤",i.value="有了我，你再也不需要移动了。拿外卖，拿零食，开空调，开电视，在所不辞。"):"衣服裤子"===e?(u.value="衣服裤子券",i.value="凭此券可以购买衣服或者裤子一件，买好看的衣服，变得更好看！"):"好看鞋子"===e?(u.value="好看鞋子券",i.value="凭此卷可以购买一双心仪已久的鞋子，价格看具体情况而定！"):"小吃一样"===e&&(u.value="小吃一样",i.value="小小奖励一下自己，可以吃点好吃的，放松一下！")},L=e=>{e.status="uploading",e.message="上传中...";const a=new FormData;a.append("file",e.file),fetch("/api/upload",{method:"POST",headers:b,body:a}).then((e=>e.json())).then((a=>{m.value=a.data,e.message="上传成功",e.status=""})).catch((e=>{console.error("上传失败：",e)}))},N=()=>{r.value="无预设",u.value="",i.value="",d.value="",s.value="",c.value=""},S=()=>{if(o.value=!0,""==i.value&&(i.value="😂这个人很懒，没有填写相关的商品详情！"),""==c.value||""==m.value||""==u.value)return l.value="请完整填好上述信息！",e.value=!0,void(o.value=!1);const t=parseFloat(d.value);if(!Number.isInteger(t))return l.value="积分只能是整数哦，请重新输入！",e.value=!0,void(o.value=!1);const n={produceName:u.value,founderId:y,produceText:i.value,produceImage:m.value,produceCredit:d.value,produceNum:s.value,customer:c.value};fetch("/api/addProduce",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${k}`},body:JSON.stringify(n)}).then((e=>{e.ok?(o.value=!1,l.value="保存商品成功!"):(console.error("保存商品失败"),l.value="保存商品失败!")})).catch((e=>{console.error("保存任务时出现错误:",e)})),a.value=!0,setTimeout((()=>{p.replace("/Produce")}),1e3),o.value=!1};return{show:e,show_1:a,message:l,isLoading:o,columns:U,onConfirm:T,showPicker:v,afterRead:L,fileList:n,presetIndex:r,title:u,desc:i,num:s,useName:c,credit:d,resetItem:N,saveItem:S,onClickLeft:f,images:t,userColumns:w,onConfirm_1:H,showPicker_1:g}}},U=l(3744);const T=(0,U.Z)(H,[["render",_]]);var Z=T},6870:function(e,a,l){l(1958),l(368),l(6742)},5077:function(e,a,l){l(1958),l(368),l(2939),l(1771),l(9137),l(1088),l(5338),l(1564),l(6565),l(1744)},2219:function(e,a,l){l(1958),l(368),l(6742),l(6196),l(2666)}}]);
//# sourceMappingURL=677.7767bcab.js.map