"use strict";(self["webpackChunkyy2"]=self["webpackChunkyy2"]||[]).push([[621],{6245:function(e,l,a){function t(e){this.message=e}t.prototype=new Error,t.prototype.name="InvalidCharacterError";var o="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var l=String(e).replace(/=+$/,"");if(l.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,o,n=0,r=0,u="";o=l.charAt(r++);~o&&(a=n%4?64*a+o:o,n++%4)?u+=String.fromCharCode(255&a>>(-2*n&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return u};function n(e){var l=e.replace(/-/g,"+").replace(/_/g,"/");switch(l.length%4){case 0:break;case 2:l+="==";break;case 3:l+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(o(e).replace(/(.)/g,(function(e,l){var a=l.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a})))}(l)}catch(e){return o(l)}}function r(e){this.message=e}function u(e,l){if("string"!=typeof e)throw new r("Invalid token specified");var a=!0===(l=l||{}).header?0:1;try{return JSON.parse(n(e.split(".")[a]))}catch(e){throw new r("Invalid token specified: "+e.message)}}r.prototype=new Error,r.prototype.name="InvalidTokenError",l.Z=u},7621:function(e,l,a){a.r(l),a.d(l,{default:function(){return D}});var t=a(1116),o=(a(8825),a(2876)),n=(a(2278),a(5185)),r=(a(3349),a(6907)),u=(a(4746),a(3164)),i=(a(6335),a(8480)),c=(a(5590),a(3579)),d=(a(492),a(2406)),s=(a(6615),a(6252)),m=a(3577);const h={style:{"--van-nav-bar-icon-color":"#f19290"}},w={class:"page-container"},p={class:"display_produce"},v=(0,s._)("br",null,null,-1),f={key:0},g={style:{transform:"translate(0px, -10px)"}},y={key:1},b={style:{display:"flex","justify-content":"center","align-items":"center"}},_=(0,s._)("br",null,null,-1),k=(0,s._)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no"},null,-1),C={style:{margin:"8px",transform:"translateY(9px)"}},V=(0,s._)("br",null,null,-1),U={style:{display:"flex","justify-content":"center","align-items":"center"}},W=(0,s._)("br",null,null,-1),H=(0,s._)("br",null,null,-1),x=(0,s._)("br",null,null,-1),T=(0,s._)("br",null,null,-1);function I(e,l,a,I,N,Z){const z=d.l2,S=c.HY,$=i.Ee,E=u.gN,A=r.zx,D=n.l0,L=o.Vq,j=t.gb;return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",h,[(0,s.Wm)(z,{title:"超市商品","left-text":"","left-arrow":"",onClickLeft:I.onClickLeft},null,8,["onClickLeft"])]),(0,s._)("div",w,[(0,s._)("div",p,[v,null===I.data?((0,s.wg)(),(0,s.iD)("div",f,[(0,s._)("div",g,[(0,s.Wm)(S,{"image-size":"26rem",description:"😭商品已售完，快去创建一\r\n            个吧！"})])])):(0,s.kq)("",!0),I.data?((0,s.wg)(),(0,s.iD)("div",y,[(0,s.Wm)(D,{class:"form-container"},{default:(0,s.w5)((()=>[(0,s._)("div",b,[(0,s.Wm)($,{width:"22vh",height:"22vh",position:"center",fit:"cover",round:"",src:I.imageUrl,onClick:I.picture},null,8,["src","onClick"])]),_,k,(0,s.Wm)(E,{label:"📌商品名称",modelValue:I.title,"onUpdate:modelValue":l[0]||(l[0]=e=>I.title=e),readonly:!0},null,8,["modelValue"]),(0,s.Wm)(E,{label:"📝商品详情",modelValue:I.desc,"onUpdate:modelValue":l[1]||(l[1]=e=>I.desc=e),type:"textarea",rows:"3",readonly:!0},null,8,["modelValue"]),(0,s.Wm)(E,{label:"💰积分价格",modelValue:I.credit,"onUpdate:modelValue":l[2]||(l[2]=e=>I.credit=e),readonly:!0},null,8,["modelValue"]),(0,s.Wm)(E,{label:"🧩商品数量",modelValue:I.num,"onUpdate:modelValue":l[3]||(l[3]=e=>I.num=e),readonly:!0},null,8,["modelValue"]),(0,s.Wm)(E,{label:"🦄创建对象",modelValue:I.founderName,"onUpdate:modelValue":l[4]||(l[4]=e=>I.founderName=e),readonly:!0},null,8,["modelValue"]),(0,s.Wm)(E,{label:"🤖商品对象",modelValue:I.useName,"onUpdate:modelValue":l[5]||(l[5]=e=>I.useName=e),readonly:!0},null,8,["modelValue"]),(0,s.Wm)(E,{label:"⏱更新时间",modelValue:I.updateTime,"onUpdate:modelValue":l[6]||(l[6]=e=>I.updateTime=e),readonly:!0},null,8,["modelValue"]),(0,s.Wm)(E,{label:"📅注册时间",modelValue:I.registerTime,"onUpdate:modelValue":l[7]||(l[7]=e=>I.registerTime=e),readonly:!0},null,8,["modelValue"]),(0,s._)("div",C,[(0,s.Wm)(A,{onClick:l[8]||(l[8]=e=>I.data.produceNum>0?I.buyItem(I.data):I.haveBuyItem()),round:"",block:"",color:"#F19290","native-type":"submit"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,m.zw)(I.data.produceNum>0?"购买商品":"已售完"),1)])),_:1}),V])])),_:1})])):(0,s.kq)("",!0),(0,s.Wm)(L,{show:I.show,"onUpdate:show":l[9]||(l[9]=e=>I.show=e),"close-on-click-overlay":!0,"show-cancel-button":!1,"show-confirm-button":!1,width:I.picturewidth},{default:(0,s.w5)((()=>[(0,s._)("div",U,[(0,s.Wm)($,{width:"100vw",height:"100vw",position:"center",fit:"cover",src:I.imageUrl},null,8,["src"])])])),_:1},8,["show","width"]),(0,s.Wm)(L,{show:I.show_1,"onUpdate:show":l[10]||(l[10]=e=>I.show_1=e),"show-cancel-button":!1,"show-confirm-button":!1,width:"50vw"},{default:(0,s.w5)((()=>[W,H,(0,s.Wm)(j,{size:"40px",vertical:"","text-size":"15px",color:"#f19290"},{default:(0,s.w5)((()=>[(0,s.Uk)("🚀拼命加载中...")])),_:1}),x,T])),_:1},8,["show"]),(0,s.Wm)(L,{show:I.show_2,"onUpdate:show":l[11]||(l[11]=e=>I.show_2=e),onConfirm:I.checkConfirm,onCancel:I.checkCancel,title:"🥰 温馨提示",message:"🦄您确定要购买这件商品了嘛？","show-cancel-button":""},null,8,["show","onConfirm","onCancel"]),(0,s.Wm)(L,{show:I.show_3,"onUpdate:show":l[12]||(l[12]=e=>I.show_3=e),title:"购买商品失败",message:"😭您的积分不够，快去完成任务获取积分吧啊💪","show-cancel-button":""},null,8,["show"]),(0,s.Wm)(L,{show:I.show_6,"onUpdate:show":l[13]||(l[13]=e=>I.show_6=e),title:"🥰 温馨提示",message:"😂您不能购买别人的专属商品哦，快去完成自己的任务，购买属于自己的商品吧！"},null,8,["show"]),(0,s.Wm)(L,{show:I.show_8,"onUpdate:show":l[14]||(l[14]=e=>I.show_8=e),title:"🥰恭喜",message:I.message,width:"70vw",height:"30vw","close-on-click-overlay":!0,"show-cancel-button":!1,"show-confirm-button":!1},null,8,["show","message"])])])],64)}var N=a(2262),Z=a(6154),z=a(2119),S=a(6245),$={setup(){const e=(0,N.iH)();e.value=.8*window.innerWidth;const l=(0,z.tv)(),a=(0,N.iH)(""),t=(0,N.iH)(!1),o=(0,N.iH)(!1),n=(0,N.iH)(!1),r=(0,N.iH)(!1),u=(0,N.iH)(!1),i=(0,N.iH)(!1),c=()=>t.value=!0,d=()=>l.replace("/Produce"),m=(0,N.iH)(""),h=(0,N.iH)(""),w=(0,N.iH)(""),p=(0,N.iH)(""),v=(0,N.iH)(""),f=(0,N.iH)(""),g=(0,N.iH)(""),y=(0,N.iH)(""),b=(0,N.iH)(""),_=(0,N.iH)(""),k=localStorage.getItem("jwtToken");k||l.replace("/login");const C={Authorization:`Bearer ${k}`};let V="";const U=()=>{Z.Z.post("/api/loginToken?token="+k).then((e=>{0==e.data.code&&(console.error(e.data.data),l.replace("/login")),console.log(e.data.data)})).catch((e=>{console.error("请求loginToken接口失败",e),l.replace("/login")}));const e=(0,S.Z)(k);V=e.id},W=l.currentRoute.value.params.id;let H=W.replace(":","");const x=async()=>{try{const e=await Z.Z.get(`/api/idSelectProduce?id=${H}`,{headers:C});_.value=e.data.data,m.value=_.value.produceImage,h.value=_.value.produceName,""==_.value.produceText?w.value="😂这个人很懒，没有填写相关的商品详情！":w.value=_.value.produceText,p.value=_.value.produceCredit,v.value=_.value.produceNum,g.value=_.value.customer,y.value=_.value.registerTime,b.value=_.value.updateTime;const l=_.value.founderId,a=await Z.Z.get(`/api/selectUser?id=${l}`,{headers:C}),t=a.data.data;f.value=t.name}catch(e){console.error("获取数据失败",e)}o.value=!1};(0,s.bv)((()=>{x(),U()}));let T="";const I=e=>{Z.Z.get(`/api/selectCredit?name=${e.customer}`,{headers:C}).then((l=>{const a=l.data.data.nameId;a==V?(T=e,n.value=!0):u.value=!0}))},$=()=>{o.value=!0,A(T)},E=()=>{},A=e=>{Z.Z.get(`/api/selectCredit?name=${e.customer}`,{headers:C}).then((l=>{console.log("获取数据成功",l);const t=l.data.data.credit;t>=e.produceCredit?Z.Z.put(`/api/buyProduce?id=${e.produceId}`,null,{headers:C}).then((e=>{console.log("任务已保存成功",e.data),o.value=!1,a.value="购买成功！",v.value=v.value-1,_.value.produceNum=_.value.produceNum-1})).catch((e=>{console.error("数据完成失败",e),a.value="购买失败！"})):r.value=!0})).catch((e=>{console.error("获取数据失败",e)})),i.value=!0,setTimeout((()=>{i.value=!1}),1e3),o.value=!1},D=()=>{};return{message:a,data:_,picturewidth:e,show:t,show_1:o,show_2:n,show_3:r,show_6:u,show_8:i,picture:c,onClickLeft:d,imageUrl:m,title:h,desc:w,credit:p,num:v,founderName:f,useName:g,registerTime:y,updateTime:b,fetchDataAndFillForm:x,checkConfirm:$,checkCancel:E,buyItem:I,haveBuyItem:D}}},E=a(3744);const A=(0,E.Z)($,[["render",I]]);var D=A},5590:function(e,l,a){a(1958),a(368),a(6742),a(7179)}}]);
//# sourceMappingURL=621.522b7c6f.js.map